<div class="card">
    <h3><%= post.title %></h3>
    <p style="white-space: pre-line;"><%= post.content %></p>
    <p><strong>Автор:</strong> <%= post.authorName %></p>
    <p><strong>Лайков:</strong> <%= post.likeCount %></p>

    <% if (user.id !== post.authorId) { %>
        <% if (post.isSubscribed) { %>
            <form action="/user/unsubscribe" method="POST">
                <input type="hidden" name="authorId" value="<%= post.authorId %>">
                <button type="submit" style="color: red;">Отписаться</button>
            </form>
        <% } else { %>
            <form action="/user/subscribe" method="POST">
                <input type="hidden" name="authorId" value="<%= post.authorId %>">
                <button type="submit" style="color: green;">Подписаться</button>
            </form>
        <% } %>
    <% } %>

    <% if (user.role === 'author' && user.id === post.authorId || user.role === 'admin') { %>
        <form action="/author/versions" method="GET" style="display:inline;">
            <input type="hidden" name="postId" value="<%= post.id %>">
            <button type="submit">Версии</button>
        </form>

        <form action="/author/compare" method="GET" style="display:inline; margin-left:10px;">
            <input type="hidden" name="postId" value="<%= post.id %>">
            <label>Версия №</label>
            <select name="v1">
                <% for (let i = 0; i < post.versionCount; i++) { %>
                    <option value="<%= i %>"><%= i %></option>
                <% } %>
            </select>
            <label>Версия №</label>
            <select name="v2">
                <% for (let i = 0; i < post.versionCount; i++) { %>
                    <option value="<%= i %>"><%= i %></option>
                <% } %>
            </select>
            <button type="submit">Сравнить</button>
        </form>
    <% } %>

    <% if (user.role === 'author' && user.id === post.authorId) { %>
        <form action="/author/editPost" method="GET" style="display:inline;">
            <input type="hidden" name="postId" value="<%= post.id %>">
            <button type="submit">Редактировать</button>
        </form>
    <% } %>

    <form action="<%= post.isLiked ? '/user/unlike' : '/user/like' %>" method="POST" style="display:inline;">
        <input type="hidden" name="postId" value="<%= post.id %>">
        <button type="submit"><%= post.isLiked ? 'Убрать лайк' : 'Поставить лайк' %></button>
    </form>
</div>